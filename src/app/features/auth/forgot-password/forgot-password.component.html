<div class="forgot-password-container">
    <!-- Background with pattern -->
    <div class="forgot-password-background">
        <div class="pattern-overlay"></div>
    </div>

    <!-- Forgot Password Card -->
    <mat-card class="forgot-password-card">
        <!-- Logo and Brand -->
        <div class="brand-section">
            <div class="logo">
                <mat-icon class="logo-icon">account_balance</mat-icon>
            </div>
            <h1 class="brand-title">{{ APP_NAME }}</h1>
            <p class="brand-subtitle">Reset Your Password</p>
        </div>

        <mat-divider></mat-divider>

        <!-- Success State -->
        <div class="success-section" *ngIf="emailSent()">
            <div class="success-content">
                <mat-icon class="success-icon">mark_email_read</mat-icon>
                <h2 class="success-title">Check Your Email</h2>
                <p class="success-message">
                    We've sent a password reset link to your email address.
                    Please check your inbox and follow the instructions to reset your password.
                </p>
                <div class="success-actions">
                    <button mat-button color="primary" (click)="onResendEmail()" [disabled]="isLoading()"
                        class="resend-button">
                        <mat-icon>refresh</mat-icon>
                        Resend Email
                    </button>
                    <button mat-raised-button color="primary" (click)="onBackToLogin()" class="back-button">
                        <mat-icon>arrow_back</mat-icon>
                        Back to Login
                    </button>
                </div>
            </div>
        </div>

        <!-- Forgot Password Form -->
        <div class="form-section" *ngIf="!emailSent()">
            <div class="form-content">
                <h2 class="form-title">Forgot Your Password?</h2>
                <p class="form-description">
                    Enter your email address and we'll send you a link to reset your password.
                </p>

                <!-- API Error Messages -->
                <div class="api-error-section" *ngIf="apiErrors().length > 0">
                    <mat-icon class="error-icon">error</mat-icon>
                    <div class="error-content">
                        <strong>Reset Failed</strong>
                        <ul class="error-list" *ngIf="apiErrors().length > 1; else singleError">
                            <li *ngFor="let error of apiErrors()">{{ error }}</li>
                        </ul>
                        <ng-template #singleError>
                            <p class="single-error-message">{{ apiErrors()[0] }}</p>
                        </ng-template>
                    </div>
                </div>

                <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="forgot-password-form">
                    <!-- Email Field -->
                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Email Address</mat-label>
                        <input matInput type="email" formControlName="email" placeholder="Enter your email address"
                            autocomplete="email">
                        <mat-icon matSuffix>email</mat-icon>
                        <mat-error *ngIf="emailError">{{ emailError }}</mat-error>
                        <mat-hint>We'll send reset instructions to this email</mat-hint>
                    </mat-form-field>

                    <!-- Submit Button -->
                    <button mat-raised-button color="primary" type="submit" class="submit-button full-width"
                        [disabled]="!canSubmit">
                        <span *ngIf="!isLoading(); else loadingTemplate">
                            <mat-icon>send</mat-icon>
                            Send Reset Link
                        </span>
                        <ng-template #loadingTemplate>
                            <mat-spinner diameter="20" color="accent"></mat-spinner>
                            <span class="loading-text">Sending...</span>
                        </ng-template>
                    </button>

                    <!-- Back to Login -->
                    <div class="form-actions">
                        <button mat-button color="primary" type="button" (click)="onBackToLogin()" class="back-link">
                            <mat-icon>arrow_back</mat-icon>
                            Back to Login
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <mat-divider *ngIf="!emailSent()"></mat-divider>

        <!-- Help Section -->
        <div class="help-section" *ngIf="!emailSent()">
            <p class="help-text">
                Need help? Contact our support team for assistance.
            </p>
            <div class="help-links">
                <button mat-button color="accent" class="help-link">
                    <mat-icon>help_outline</mat-icon>
                    Help Center
                </button>
                <button mat-button color="accent" class="help-link">
                    <mat-icon>contact_support</mat-icon>
                    Contact Support
                </button>
            </div>
        </div>
    </mat-card>

    <!-- Footer -->
    <div class="forgot-password-footer">
        <p class="footer-text">
            Powered by blockchain technology • Secure • Compliant
        </p>
        <div class="footer-links">
            <a href="#" class="footer-link">Privacy Policy</a>
            <span class="divider">•</span>
            <a href="#" class="footer-link">Terms of Service</a>
            <span class="divider">•</span>
            <a href="#" class="footer-link">Security</a>
        </div>
    </div>
</div>